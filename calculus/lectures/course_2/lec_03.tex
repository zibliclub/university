\lesson{3}{от 12 сен 2023 10:30}{Теорема о неявной функции}


\section{Теорема о неявной функции}

\begin{theorem}[О неявной функции]\label{theorem:1}
    Пусть $ F(x,y) $ отображает окрестность $ U(x_0;y_0) \subset \R^2 $ в $ \R, \ F:U(x_0,y_0)\rightarrow\R $.

    Пусть $ F $ имеет следующие свойства:
    \begin{enumerate}
        \item $ F(x_0,y_0) = 0 $.
        \item $ F(x,y) \in C^P(U,\R), \ p \geqslant 1 $.
        \item $ \frac{\delta F}{\delta y}(x_0,y_0)\ne 0 $.
    \end{enumerate}

    Тогда $ \exists $ открезки $ I_x,I_y: \ f:I_x \rightarrow I_y $:
    \begin{enumerate}
        \item $ I_x \times I_y \subset U(x_0,y_0) $.
        \item $ \forall x \in I_x \ y = f(x) \iff F(x,y) = 0 $.
        \item $ f \in C^P(I_x,I_y) $.
        \item $ \forall x \in I_x \ f'(x) = -\frac{F_x'(x,y)}{F_y'(x,y)} $.
    \end{enumerate}
\end{theorem}

\begin{proof}
    Будем считать, что окрестность $ U(x_0,y_0) $ -- круг с центром в точке $ (x_0,y_0) $. Для определенности будем считать, что \\ $ F_y'(x_0,y_0) > 0 $.

    В силу непрерывности $ F_y' \ \exists $ окрестность $ V(x_0,y_0) \subset U(x_0,y_0): \ \forall(x,y) \in V \ F_y'(x,y) > 0 $. Если посмотрим на функцию $ F(x,y) $ при фиксированной $ x $ как на функцию по переменной $ y $, то $ F(\overline{x},y) $ будет монотонной (в силу того, что $ F_y'(\overline{x},y) > 0 $). Тогда для $ \beta = \frac{1}{2}\tau $, где $ \tau $ -- радиус круга $ U(x_0,y_0) $.
    \[
        F(x_0,y_0 - \beta) < F(x_0,y_0) < F(x_0, y_0 + \beta).
    \]

    Так как $ F(x,y) $ непрерывна, то $ \exists\delta > 0: \ \forall x \in [x_0 - \delta, x_0 + \delta] $
    \[
        F(x,y_0 - \beta) < 0, \quad F(x,y_0 + \beta) > 0.
    \]

    При фиусированном $ x $ функция $ f(\overline{x},y) $ непрерывно монотонна, на концах отрезка $ [y_0 - \beta;y_0 + \beta] $ имеет разные знаки, тогда $ \exists!y_x \in [y_0-\beta;y_0+\beta]: \ F(\overline{x},y_x) = 0 $. В силу непрерывности $ F(x,y) $ по $ x, \ \exists\delta>0: \ \forall x \in [x_0 - \delta;x_0 + \delta] \ F(x,y_x = 0) $.

    Определим функцию $ f:[x_0-\delta;x_0+\delta]\rightarrow[y_0-\beta;y_0 + \beta] $ положив, что $ y=f(x) \iff F(x,y) = 0 $, то есть $ y_x = f(x) $.

    Положим $ f\in C^{(P)}(I_x,I_y) $.
    \begin{enumerate}
        \item Покажем, что $ f $ -- непрерывна.

              Для начала покажем, что $ f $ непрерывна в точке $ x_0 $.

              Пусть $ \epsilon > 0 $ задано. Покажем, что $ \exists \delta > 0: \ \forall x \in (x_0 - \delta;x_0 + \delta) \implies f(x) \in (y_0-\epsilon;y_0+\epsilon) $.

              Будем считать, что $ \epsilon < \beta \implies [y_0-\epsilon;y_0+\epsilon]\subset [y_0-\beta;y_0 + \beta] \implies $ найдется отрезок $ [x_0-\delta;x_0+\delta] $ и функция
              \[
                  \hat{f}(x): [x_0-\delta;x_0 + \delta]\rightarrow[y_0 -\epsilon;y_0+\epsilon],
              \]
              \[
                  \hat{f}(x) = y \iff F(x,y) = 0.
              \]

              Но на $ [x_0 - \delta;x_0 + \delta] \ \hat{f}(x) \equiv f(x) \implies f\big([x_0-\delta;x_0+\delta]\big)\subset[y_0-\epsilon;y_0+\epsilon] \implies f(x) $ непрерывна в точке $ x_0 $.

              Теперь, пусть $ x \in I_x = [x_0 -\delta;x_0+\delta] $.

              Для точки $ (x,y_x) $ выполнены все условия теоремы $ \implies \exists $ отрезок $ [x-\alpha;x+\alpha] = \widehat{I}_x $ и $ [y_x - \gamma;y_x + \gamma] = \widehat{I}_y $ и функция $ g:\widehat{I}_x \rightarrow \widehat{I}_y: \ g(\overline{x}) = y \iff F(\overline{x},y) = 0 \ \forall \overline{x} \in \widehat{I}_x $.

              Но на отрезке $ [x-\alpha;x + \alpha] $ функция $ g(x)\equiv f(x) $.

              По построению $ g(x) $ непрерывна в точке $ x $, следовательно и $ f(x) $ непрерывна в точке $ x $.

        \item Покажем, что $ f(x) $ дифференцируема на $ I_x $.

              Пусть $ x \in I_x, \ x + \Delta x \in I_x, \ y = f(x), \ y + \Delta y = f(x + \Delta x) $. Тогда
              \begin{multline*}
                  0 = \equalto{F(x+\Delta x, y+\Delta y)}{0} - \equalto{F(x,y)}{0} = \\
                  = \left|\begin{array}{c}
                      \text{Теорема} \\ \text{о среднем}
                  \end{array}\right| = F_x'(x+\theta\cdot \Delta x, y + \theta \cdot \Delta y)\Delta x + \\
                  + F_y'(x + \theta \cdot \Delta x, y + \theta \cdot \Delta y)\Delta y, \ 0 < \theta < 1 \implies
              \end{multline*}

              \[
                  \implies \frac{\Delta y}{\Delta x} = \frac{- F_x'(x + \theta \cdot \Delta x, y + \theta \cdot \Delta y)}{F_y'(x + \theta \cdot \Delta x, y + \theta \cdot \Delta y)}
              \]

              Поскольку $f$ -- непрерывная функция, то при $\Delta x \rightarrow 0: \ \Delta y \rightarrow 0 \ \big(f(x + \Delta x) - f(x) = \Delta y \rightarrow 0\big)$. Тогда:
              \begin{equation}\label{eq:3}
                  f'(x) = \underset{\Delta x \rightarrow 0}{\lim}\frac{\Delta y}{\Delta x} = \frac{-F_x'(x,y)}{F_y'(x,y)}
              \end{equation}

              Из теоремы о непрерывности композиции непрерывной функции $\implies f'(x)$ -- непрерывна в точке $x \implies f \in C^{(1)}(I_x,I_y)$.

              Если $F \in C^{(p)}(U,\R), \ p > 1$, то:
              \begin{multline}\label{eq:4}
                  \quad f''(x) = \left(-\frac{F_x'(x,y)}{F_y'(x,y)}\right)' = \frac{(-F_x')' \cdot F_y' + F_x' \cdot (F_y')'}{(F_y')^2} = \\
                  = \frac{-\big(F_{xx}'' + F_{xy}'' \cdot \equalto{f'(x)}{y'(x)}\big)\cdot F_y' + F_x'\cdot \big(F_{yx}'' + F_{yy}'' \cdot f'(x)\big)}{(F_y')^2},
              \end{multline}
              где $F_{xx}'', F_{xy}'', F_{yy}''$ вычисляются в точке $\big(x,f(x)\big)\implies f(x) \in C^{(2)}(I_x,I_y)$, если $F(x,y) \in C^{(2)}(U,\R)$.

              Заметим, что в левой части выражения \ref{eq:4} производная функции $f$ имеет порядок на $1$ больше, чем производная функции $f$ в правой части. Тогда по индукции можно показать, что $f \in C^{(p)}(I_x,I_y)$, если $F(x,y) \in C^{(p)}(U,\R)$.
    \end{enumerate}
\end{proof}

\begin{theorem}[О неявной функции вида $F(x^1,\ldots,x^m,y) = 0$]
    Если $F:U \rightarrow \R$, где $U \subset \R^{m+1}$ -- окрестность точки $(x_0,y_0) = (x_0^1, \ldots, x_0^m,y_0) \in \R^{m+1}$:
    \begin{enumerate}
        \item $F(x_0,y_0) = F(x_0^1,\ldots,x_0^m,y_0) = 0$.
        \item $F \in C^{(p)}(U,\R)$.
        \item $F_y'(x_0,y_0) = F_y'(x_0^1,\ldots,x_0^m,y_0) \ne 0$, тогда $\exists (m+1)$-мерный промежуток $I = I_x^m \times I_y^1$, где:
              \begin{align*}
                   & I_x^m = \big\{x = (x^1,\ldots,x^m) \in \R^m \ \big| \ |x^i - x_0^i| < \alpha^i, \ i = \overline{1,m}\big\}, \\
                   & I_y^1 = \big\{y \in \R \ \big| \ |y - y_0| < \beta\big\},
              \end{align*}
              $I \subset U$ и $\exists$ функция $f:I_x^m \rightarrow I_y^1:$
              \begin{enumerate}
                  \item $f \in C^{(p)}(I_x^m, I_y^1)$.
                  \item $\forall (x,y) \in I = I_x^m \times I_y^1 \quad y = f(x^1,\ldots,x^m) \iff F(x^1,\ldots,x^m,y) = 0$.
                  \item $f'(x) = -\frac{F_x'(x,y)}{F_y'(x,y)}$, то есть $\frac{\delta f}{\delta x^i} = -\frac{F_{x^i}'(x,y)}{F_y'(x,y)}$.
              \end{enumerate}
    \end{enumerate}
\end{theorem}

\begin{proof}
    Повторить доказательство теоремы \ref{theorem:1}, понимая под $ x $ набор $ (x^1,\ldots,x^m) $, под $ \delta $ -- набор $ (\alpha^1,\ldots,\alpha^m) $.

    Если в функциях $ f(x^1,\ldots,x^m) $ и $ F(x^1,\ldots,x^m,y) $ фиксировать все переменные, кроме $ x^i $ и $ y $, то мы окажемся в условиях теоремы \ref{theorem:1}, при этом роль $ x $  играет переменная $ x^i \implies $ верен пункт 3.

    И рассуждая аналогично доказательству теоремы \ref{theorem:1}, получаем, что
    \[
        f\in C^{(p)}(I_x^m, I^1_y)\text{, если }F \in C^{(p)}(U,\R).
    \]
\end{proof}

\begin{note}[Общий случай]
    Рассмотрим систему уравнений:
    \begin{equation}
        \left\{\begin{array}{l}\label{eq:5}
            F^1 (x^1,\ldots,x^m,y^1,\ldots,y^n) = 0 \\
            F^2 (x^1,\ldots,x^m,y^1,\ldots,y^n) = 0 \\
            \vdots                                  \\
            F^n (x^1,\ldots,x^m,y^1,\ldots,y^n) = 0
        \end{array}\right.,
    \end{equation} которую будем решать относительно $ y^1,\ldots,y^n $, то есть искать \emph{локально} эквивалентную систему функциональных связей,
    \begin{equation}
        \left\{\begin{array}{l}\label{eq:6}
            y^1 = f^1(x^1,\ldots,x^m) \\
            y^2 = f^1(x^1,\ldots,x^m) \\
            \vdots                    \\
            y^n = f^1(x^1,\ldots,x^m)
        \end{array}\right..
    \end{equation}

    Для кратности и удобства будем считать, что $ x=(x^1,\ldots,x^m), \ y = (y^1,\ldots,y^n) $, тогда систему \ref{eq:5} будем записывать как $ F(x,y) = 0 $, а систему \ref{eq:6} -- как $ y=f(x) $. Если
    \[
        \begin{array}{cc}
            x_0 = (x_0^1,\ldots,x_0^m),          & y_0 = (y_0^1,\ldots,y_0^n),       \\
            \alpha = (\alpha^1,\ldots,\alpha^m), & \beta = (\beta^1,\ldots,\beta^n),
        \end{array}
    \] то запись $ |x-x_0| < \alpha $ или $ |y-y_0| < \beta $ будет означать, что
    \[
        \begin{array}{l}
            |x^i - x_0^i| < \alpha^i, \ i = \overline{1,m} \\
            |y^i - y_0^i| <\beta^i,\ i = \overline{1,n}
        \end{array}.
    \]

    Далее положим, что
    \begin{align*}
         & f'(x) = \left(\begin{matrix}
                             \frac{\delta f^1}{\delta x^1} & \cdots & \frac{\delta f^1}{\delta x^m} \\
                             \vdots                        & \ddots & \vdots                        \\
                             \frac{\delta f^n}{\delta x^1} & \cdots & \frac{\delta f^n}{\delta x^m}
                         \end{matrix}\right) (x)     \\
         & F_x'(x,y) = \left(\begin{matrix}
                                 \frac{\delta F^1}{\delta x^1} & \cdots & \frac{\delta F^1}{\delta x^m} \\
                                 \vdots                        & \ddots & \vdots                        \\
                                 \frac{\delta F^n}{\delta x^1} & \cdots & \frac{\delta F^n}{\delta x^m}
                             \end{matrix}\right) (x,y) \\
         & F_y'(x,y) = \left(\begin{matrix}
                                 \frac{\delta F^1}{\delta y^1} & \cdots & \frac{\delta F^1}{\delta y^m} \\
                                 \vdots                        & \ddots & \vdots                        \\
                                 \frac{\delta F^n}{\delta y^1} & \cdots & \frac{\delta F^n}{\delta y^m}
                             \end{matrix}\right) (x,y)
    \end{align*}

    Заметим, что матрица $ F_y'(x,y) $ -- квадратная, следовательно она обратима тогда и только тогда, когда $ \big|F_y'(x,y)\big| \ne 0 $ (определитель $ \ne 0 $).

    Обозначим матрицу, обратную к $ F_y'(x,y) $ как $ \big[F_y'(x,y)\big]^{-1} $.
\end{note}

\begin{theorem}[О неявной функции, общий случай]
    Пусть $ F:U(x_0,y_0) \rightarrow \R^n $, где $ U(x_0,y_0) \subset \R^{m+n} $ -- окрестность точки $ (x_0,y_0) $ такая, что
    \begin{enumerate}
        \item $ F\in C^{(p)}(U,\R^n), \ p \geqslant 1 $.
        \item $ F(x_0,y_0) = 0 $.
        \item $ F_y'(x_0,y_0) $ -- обратная матрица.
    \end{enumerate}

    Тогда $ \exists (n+m) $-мерный промежуток $ I = I_x^m \times I_y^n \subset U(x_0;y_0) $, где
    \begin{align*}
        I_x^m & = \big\{x\in \R^m \ \big| \ |x - x_0| < \alpha \big\}, \\
        I_x^n & = \big\{y\in \R^n \ \big| \ |y - y_0| < \beta \big\},
    \end{align*} то есть $ f:I_x^m \rightarrow I_y^n $:
    \begin{itemize}
        \item $ \forall (x,y) \in I_x^m \times I_y^n \ F(x,y) = 0 \iff y = f(x) $.
        \item $ f'(x) = -\big[F_y'(x,y)\big]^{-1} \cdot F_x'(x,y) $.
    \end{itemize}
\end{theorem}

\begin{proof}
    Например, можно посмотреть в Зориче.
\end{proof}

\section{Приложение теоремы о неявной функции}

\begin{definition}[Диффиоморвизм класса $ C^{(p)} $, гомеоморфизм]
    Пусть $ D,G $ -- области в $ \R^n $. Отображение $ f:D \rightarrow G $ называтеся \emph{диффиоморфизмом класса $ C^{(p)} $}, $ p \geqslant 0 $, если:
    \begin{enumerate}
        \item $ f $ -- обратимое.
        \item $ f \in C^{(p)}(D,G) $.
        \item $ f^{-1} \in C^{(p)}(D,G) $.
    \end{enumerate}

    При $ p=0 \ f $ называется \emph{гомеоморфизмом}, то есть $ f $ -- гомеоморфизм, если $ f $ -- взаимно однозначное отображение и $ f,f^{-1} $ -- непрерывны.
\end{definition}

\begin{example}
    $ f:\R \rightarrow\R, \ f(x) = e^x $ -- нет.

    $ f:\R \rightarrow\R_+, \ f(x) = e^x $ -- да, диффиоморфизм класса $ C^\infty $.
\end{example}

\begin{example}
    $ f:\R \rightarrow\R, \ f(x) = x^2 $ -- нет.

    $ f:\R_+ \rightarrow \R_+ $ -- да, диффиоморфизм класса $ C^\infty $.
\end{example}

\begin{example}
    $ f:\R \rightarrow\R, \ f(x) = x^3 $ -- гомеоморфизм класса $ C^0 $, но не диффиоморфизм, так как $ f^{-1} = \sqrt[3]{y} $ теряет непрерывность.
\end{example}

\begin{theorem}[Об обратной функции]
    Пусть $ D $ -- область в $ \R^n, \ f:D \rightarrow \R^n, \ x_0 \in D $. Кроме того,
    \begin{itemize}
        \item $ f\in C^{(p)}(D,\R^n), \ p \geqslant 1 $.
        \item $ f(x_0) = y_0 $.
        \item $ \underset{(\text{матрица Якоби в }x_0)}{f'(x_0)} $ -- обратимая.
    \end{itemize}

    Тогда $ \exists $ окрестности $ U,V $ точек $ x_0 $ и $ y_0 $ соответственно:
    \begin{itemize}
        \item $ f:U \rightarrow V $ -- диффиоморфизм $ U $ на $ V $ класса $ C^{(p)}(U,V) $.
        \item $ \forall y \in V \ [f^{-1}]'(y) = [f'(x)]^{-1}, \ y = f(x) $.
    \end{itemize}
\end{theorem}

\begin{proof}
    Рассмотрим $ F(x,y) = y - f(x) $.
    \begin{enumerate}
        \item $ F(x,y) \in C^{(p)}(D\times \R^n, \R^n) $.
        \item $ F_x'(x_0,y_0) = - f'(x) $ -- обратима.
        \item $ F(x,y) = 0 \iff y = f(x) $.
    \end{enumerate}

    Следовательно, по теореме \ref{theorem:1} $ \exists n $-мерные промежутки $ I_x^n $ и $ I_y^n $ и $ \exists $ отображение $ g(y) $:
    \begin{enumerate}
        \item $ g:I_y^n \rightarrow I_x^n $.
        \item $ g(y) = x \iff F(x,y) = 0 \iff y = f(x) $.
        \item $ g(y)\in C^{(p)}(I_y^n, I_x^n) $.
        \item $ \forall y \in I_y^n \ g'(y) = - \Big[F_x'\big(g(y),y\big)\Big] \cdot F'_y\big(g(y),y\big) $, где $ g'(y), \ \Big[F_x'\big(g(y),y\big)\Big], $ \\ $ F'_y\big(g(y),y\big) $ -- матрицы.
    \end{enumerate}
    \begin{align*}
        f(x)      & = \left(\begin{matrix}
                                f^1(x^1,\ldots,x^n) \\
                                f^2(x^1,\ldots,x^n) \\
                                \vdots              \\
                                f^n(x^1,\ldots,x^n)
                            \end{matrix}\right)                                                                                       \\
        F(x,y)    & = \left(\begin{matrix}
                                y^1 - f^1(x^1,\ldots,x^n) \\
                                y^2 - f^2(x^1,\ldots,x^n) \\
                                \vdots                    \\
                                y^n - f^n(x^1,\ldots,x^n)
                            \end{matrix}\right) = \left(\begin{matrix}
                                                            F^1(x,y) \\
                                                            F^2(x,y) \\
                                                            \vdots   \\
                                                            F^n(x,y)
                                                        \end{matrix}\right)                                                           \\
        F_x'(x,y) & = \left(\begin{matrix}
                                \frac{\delta F^1}{\delta x^1} & \cdots & \frac{\delta F^1}{\delta x^n} \\
                                \frac{\delta F^2}{\delta x^1} & \cdots & \frac{\delta F^2}{\delta x^n} \\
                                \vdots                        & \ddots & \vdots                        \\
                                \frac{\delta F^n}{\delta x^1} & \cdots & \frac{\delta F^n}{\delta x^n}
                            \end{matrix}\right)(x,y) = \left(\begin{matrix}
                                                                 -\frac{\delta f^1}{\delta x^1} & \cdots & -\frac{\delta f^1}{\delta x^n} \\
                                                                 -\frac{\delta f^2}{\delta x^1} & \cdots & -\frac{\delta f^2}{\delta x^n} \\
                                                                 \vdots                         & \ddots & \vdots                         \\
                                                                 -\frac{\delta f^n}{\delta x^1} & \cdots & -\frac{\delta f^n}{\delta x^n}
                                                             \end{matrix}\right)(x) \\
        F_y'(x,y) & = \left(\begin{matrix}
                                \frac{\delta F^1}{\delta y^1} & \cdots & \frac{\delta F^1}{\delta y^n} \\
                                \frac{\delta F^2}{\delta y^1} & \cdots & \frac{\delta F^2}{\delta y^n} \\
                                \vdots                        & \ddots & \vdots                        \\
                                \frac{\delta F^n}{\delta y^1} & \cdots & \frac{\delta F^n}{\delta y^n}
                            \end{matrix}\right)(x,y) = \left(\begin{matrix}
                                                                 1      & 0      & \cdots & 0      \\
                                                                 0      & 1      & \cdots & 0      \\
                                                                 \vdots & \vdots & \ddots & \vdots \\
                                                                 0      & 0      & \cdots & 1
                                                             \end{matrix}\right).
    \end{align*}

    Положим $ V = I^n_y, \ U = g(V) $.

    Тогда из 1. и 2. $ \implies f\big|_U $ и $ g\big|_V $ -- взаимно обратны.

    Из 4. $ \implies \forall y \in V $
    \begin{align*}
         & g'(y) = -\Big[F_x'\big(g(y),y\big)\Big]^{-1} = \big[f'(x)\big]^{-1}, \\
         & g'(y) = \big[f^{-1}(y)\big]^{-1} \implies
    \end{align*}
    \[
        \implies \big[f'(x)\big]^{-1} = \big[f^{-1}(x)\big]'.
    \]

    Исходя из свойств отображения $ f $ и приведенных выше построений, $ f $ -- диффиоморфизм.
\end{proof}