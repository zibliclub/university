\section{Деревья. Первая теорема о деревьях.}

\begin{definition}[Ациклический граф, дерево]
    Граф называется \emph{ациклическим}, если в нем нет цикла. Связный ациклический граф называется \emph{деревом}.
\end{definition}

\begin{theorem}[Первая теорема о деревьях]
    Для $ (n,m) $-графа $ G $ следующие утверждения эквивалентны:
    \begin{description}
        \item[$ \quad 1. $] $ G $ -- дерево, то есть связный ациклический граф.
        \item[$ \quad 2. $] $ G $ -- связен и $ m = n - 1 $.
        \item[$ \quad 3. $] $ G $ -- ациклический и $ m=n-1 $.
    \end{description}
\end{theorem}

\begin{proof}\leavevmode
    \begin{description}
        \item[$ \boxed{1. \Rightarrow 2.} $] Пусть граф $ G = (V,E) $ связен и ациклический.

              Очевидно, что $ G $ -- плоский граф, имеющий одну (внешнюю) грань. По формуле Эйлера:
              \[
                  n-m+1=2 \implies m = n-1.
              \]

        \item[$ \boxed{2. \Rightarrow 3.} $] Пусть $ G $ связен и $ m = n-1 $.

              Предположим противное, то есть в графе $ G $ есть цикл.

              Рассмотрим произвольное ребро $ e $ этого цикла и удалим его из графа $ G $.

              По лемме об удалении ребра, граф $ G - e $ тоже связен, а число ребер в нем: $ n-2 $, но по теореме \ref{theorem:1}, число ребер в связном графе $ \geqslant n-1 $ -- противоречие.

              Значит в графе $ G $ циклов нет $ \implies G $ -- ациклический.

              \newpage

        \item[$ \boxed{3. \Rightarrow 1.} $] Пусть $ G $ ациклический и число ребер $ m = n - 1 $.

              Докажем, что $ G $ -- связен. Обозначим $ k $ -- число компонент связности.

              Пусть $ i $-ая компонента является $ (n_i,m_i) $-графом, $ i = \overline{1,k} $. Каждая компонента является деревом и по ранее доказанномму $ m_i = n_i - 1 $, тогда
              \[
                  n-1 = m = \sum_{i=1}^{k}m_i = \sum_{i=1}^{k}(n_i-1)=\sum_{i=1}^{k}n_i - k = n - k \implies \boxed{k = 1},
              \]
              то есть в графе $ G $ одна компонента связности $ \implies G $ -- связен.
    \end{description}
\end{proof}

\section{Деревья. Вторая теорема о деревьях.}

\begin{theorem}[Вторая теорема о деревьях]
    Для $ (n,m) $-графа $ G $ следующие утверждения эквивалентны:
    \begin{description}
        \item[$ \quad 1. $] $ G $ -- дерево, то есть связный ациклический граф.
        \item[$ \quad 4. $] $ G $ -- ациклический и если любую пару его несмежных вершин соединить ребром, то полученный граф будет содержать ровно один цикл.
        \item[$ \quad 5. $] Любые две вершины графа $ G $ соединены единственной простой цепью.
    \end{description}
\end{theorem}

\begin{proof}\leavevmode
    \begin{description}
        \item[$ \boxed{1. \Rightarrow 4.} $] Пусть $ G $ дерево, то есть связный ациклический граф.

              В связном графе $ G $ любые две несмежные вершины $ u $ и $ v $ соединены простой $ (u,v) $-цепью.

              Если соединены $ u $ и $ v $ ребром $ e $, то образуется цикл. А два цикла образоваться не могут в силу свойства циклов.

        \item[$ \boxed{4. \Rightarrow 5.} $] Пусть $ G $ ациклический и если любую пару его несмежных вершин соединить ребром, то полученный граф будет содержать ровно один цикл.

              Любые две несмежные вершины $ u $ и $ v $ графа $ G $ соединимы, иначе при добавлении ребра не получился бы цикл.

              Любые две смежные вершины тоже соединимы. В силу леммы о выделении простой цепи любые две вершины графа $ G $ соединены цепью, а две цепи быть не может, иначе в графе $ G $ был бы цикл, а он ациклический.

        \item[$ \boxed{5. \Rightarrow 1.} $] Поскольку любые две вершины графа $ G $ соединены одной простой цепью, то граф связен.

              Если бы в графе $ G $ был цикл, то любые две вершины этого цикла были бы соединены двумя цепями, а это невозможно $ \implies G $ -- ациклический.
    \end{description}
\end{proof}

\section{Теорема Кэли о числе помеченных $n$-вершинных деревьев (с леммой).}

\begin{lemma}\label{lemma:1}
    При $ n \geqslant 2 $ существует взаимнооднозначное соответствие между множеством всех помеченных $ n $-вершинных деревьев с метками $ 1,2,\ldots,n $ и множеством всех слов длины $ n-2 $ в алфавите $ \{1,2,\ldots,n\} $.
\end{lemma}

\begin{proof}\leavevmode
    \begin{enumerate}
        \item Докажем, что каждому дереву $ T $ с множеством вершин \\ $ V = \{1,2,\ldots,n\} $ можно однозначно поставить в соответствие слово длины $ n-2 $ в алфавите $ \{1,2,\ldots,n\} $ (код Прюфера (чей блин)).

              Если $ n=2 $, то сопоставим дереву $ T $ слово длины $ 0 $ («пустое» слово).

              Пусть теперь $ n \geqslant 3 $. Согласно лемме о литьях дерева (искать в конспекте) в дереве $ T $ есть листья.

              Обозначим через $ v_1 $ первый лист дерева $ T $ (то есть висячую вершину с наименьшим номером), а через $ e_1 = v_1u_1 $ -- соответствующее ребро дерева $ T $.

              Удалив из $ T $ вершину $ v_1 $ вместе с ребром $ e_1 $ получим новое дерево $ T_1 $. В нем снова найдем лист с наименьшим номером $ v_2 $ и ребро $ e_2 = v_2u_2 $. Эта редукция повторяется, пока после удаления $ e_{n-2} = v_{n-2}u_{n-2} $ не останется единственное ребро $ e_{n-1}=v_{n-1}u_{n-1} $.

              Тогда слово $ \Omega = u_1u_2\ldots u_{n-2} $ однозначно определяется деревом $ T $ (код Прюфера).

        \item Покажем, что при $ n \geqslant 2 $ каждое слово вида $ \Omega = u_1u_2\ldots u_{n-2} $, где $ u_i \in V = \{1,2,\ldots,n\} $ однозначно определяет некоторое дерево на множестве вершин $ V $. В $ V $ есть номер, отсутствующий в $ \Omega $.

              Найдем наименьший номер $ v_1 \in V $, который не входит в $ \Omega $. Этот номер определяет ребро $ e_1=v_1u_1 $.

              Вычеркнем $ v_1 $ из $ V $ и $ u_1 $ из $ \Omega $. Найдем наименьший номер $ v_2 \in V $ и положим ребро $ e_2 = v_2u_2 $ и так далее.

              После определения ребра $ e_{n-2}=v_{n-2}u_{n-2} $ в множестве \\ $ V\setminus\{v_1,v_2,\ldots,v_{n-2}\} $ останется всего два числа. Они определяют последнее ребро $ e_{n-1} = v_{n-1}v_n $.

              Осталось доказать, что граф $ T = (V,E) $ является деревом, где $ E = \{e_1,e_2,\ldots,e_{n-1}\} $.

              Действительно, одно ребро $ e_{n-1} $ образует дерево. Пусть ребра $ e_{n-1},e_{n-2},\ldots,e_{i+1} $ образуют дерево $ T', \ i = \overline{1,n-2} $.

              Тогда ребра $ e_{n-1},e_{n-2},\ldots,e_{i+1},e_i $, где $ e_i = v_iu_i $, тоже образуют дерево, так как $ u_i $ является вершиной дерева $ T' $, а $ v_i $ -- нет.
    \end{enumerate}
\end{proof}

\begin{theorem}[А. Кэли, 1889]
    Число различных помеченных деревьев с $ n $ вершинами равно
    \[
        t_n = n^{n-2}.
    \]
\end{theorem}

\begin{proof}
    При $ n=1 $ формула, очевидно, верна.

    При $ n \geqslant 2 $ в силу леммы \ref{lemma:1} число помеченных $ n $-вершинных деревьев равно числу слов длины $ n-2 $, в которых каждая «буква» может принимать любую из $ n $ значений $ 1,2,\ldots,n $, а таких слов всего $ n^{n-2} $.
\end{proof}

\section{Центр дерева. Центральные и бицентральные деревья. Теорема Жордана.}

\begin{note}
    $ d(u,v) $ -- \emph{длина} самой короткой простой $ (u,v) $-цепи (длина -- число ребер).
\end{note}

\begin{definition}[Эксцентриситет]
    \emph{Эксцентриситет} вершины $ v $ -- расстояние до самой удаленной от $ v $ вершины графа:
    \[
        \epsilon(v) = \underset{u \in V}{\max}d(v,u).
    \]
\end{definition}

\begin{definition}[Радиус]
    \emph{Радиус} связного графа -- это наименьший из эксцентриситетов его вершин:
    \[
        \tau(G) = \underset{v \in V}{\min}\epsilon(v).
    \]
\end{definition}

\begin{definition}[Центральная вершина]
    Вершина называется \emph{центральной}, если ее эксцентриситет равен радиусу графа.
\end{definition}

\begin{definition}[Центр графа]
    Множество центральных вершин графа называется его \emph{центром}.
\end{definition}

\begin{example}
    Центр графа:
    \begin{figure}[H]
        \centering
        \incfig{fig_25}
        \label{fig:fig_25}
    \end{figure}
\end{example}

\begin{definition}[Центральное, бицентральное дерево]
    Дерево, центр которого состоит из одной вершины, называется \emph{центральным}, а дерево, центр которого состоит из двух смежных вершин -- \emph{бицентральным}.
\end{definition}

\begin{theorem}[Жордан]
    Центр любого дерева состоит из одной или двух смежных вершин.
\end{theorem}

\begin{proof}
    Утверждение очевидно для деревьев $ K_1 $ и $ K_2 $.

    Пусть $ T = (V,E) $ -- некоторое дерево и $ | V | = n \geqslant 3 $. Удалим из дерева $ T $ все листья. Заметим, что при этом эксцентриситет каждой вершины оставшегося дерева $ T' $ уменьшился ровно на $ 1 $.

    Это означает, что центры деревьев $ T $ и $ T' $ совпадают. Продолжая процесс удаления листьев, мы получим либо дерево $ K_1 $, либо дерево $ K_2 $.
\end{proof}

\section{Изоморфизм деревьев. Процедура кортежирования (на примере). Теорема Эдмондса.}

\begin{note}[Процедура кортежирования дерева]\leavevmode
    \begin{description}
        \item[Вход:] $ n $-вершинное дерево $ T = (V,E) $.
        \item[Выход:] Список натуральных чисел, представляющий кортеж $ T $.
    \end{description}
    \begin{figure}[H]
        \centering
        \incfig{fig_26}
        \label{fig:fig_26}
    \end{figure}
\end{note}

\begin{theorem}[Эдмондс]
    Для изоморфизма деревьев необходимо и достаточно, чтобы совпадали их центральные кортежи.
\end{theorem}

\begin{proof}\leavevmode
    \begin{description}
        \item[$ \boxed{\Rightarrow} $] $ T \cong T' $, тогда при любом изоморфизме $ \phi $ множество $ V_1 $ листьев дерева $ T $ взаимнооднозначно отображается на множество $ V_1' $ дерева $ T' $. Соответствуют друг другу множества $ V_2 $ и $ V_2' $ вершин второго уровня деревьев и так далее.

              Поэтому соответствующие друг другу вершины имеют одинаковый уровень и получают одинаковые кортижи. В частности совпадают центральные вершины.

        \item[$ \boxed{\Leftarrow} $] Пусть кортежи $ T $ и $ T' $ одинаковые ($ c(T) = c(T') $). По кортежу дерева $ T $ однозначно восстанавливается само дерево $ T $, а по кортежу дерева $ T' $ -- однозначно восстанавливается такое же дерево $ T' \implies T \cong T' $.
    \end{description}
\end{proof}

\section{Вершинная и реберная связность графа. Основное неравенство связности.}

\begin{definition}[Вершинная связность (связность)]
    \emph{Вершинной связностью (связностью)} обыкновенного нетривиального графа $ G $ называется наименьшее число вершин, в результате удаления которых получается несвязный или тривиальный граф:
    \[
        \mathcal{X}(G).
    \]
\end{definition}

\begin{note}
    Для тривиального графа по определению полагаем
    \[
        \mathcal{X}(O_1) = 0.
    \]
\end{note}

\begin{example}
    Для $ C_5,K_5 $ и $ C_3 $
    \begin{figure}[H]
        \centering
        \incfig{fig_27}
        \label{fig:fig_27}
    \end{figure}
\end{example}

\newpage

\begin{definition}[Реберная связность]
    \emph{Реберной связностью} нетривиального графа называется наименьшее число ребер, в результате удаления которых получается несвязный граф:
    \[
        \lambda(G).
    \]
\end{definition}

\begin{example}
    $ \lambda(O_1) = 0 $,
    \begin{figure}[H]
        \centering
        \incfig{fig_28}
        \label{fig:fig_28}
    \end{figure}
\end{example}

\begin{theorem}[Основное неравенство связности]
    Для любого графа $ G $
    \[
        \mathcal{X}(G) \leqslant \lambda(G).
    \]
\end{theorem}

\begin{proof}
    Если граф несвязный или тривиальный, то
    \[
        \mathcal{X}(G) = 0 = \lambda(G).
    \]

    Пусть $ G = (V,E) $ связный и нетривиальный $ \implies \lambda(G) = \lambda > 0 $.

    Выберем в графе $ G \ \lambda $ ребер, в результате удаления которых получается несвязный граф, обозначим:
    \[
        L \subset E,
    \]
    $ | L | = \lambda > 0, \ G - L $ -- несвязный.

    Из определения реберной связности и лемме об удалении ребра следует, что граф $ G - L $ имеет ровно две компоненты связности, причем концы каждого ребра из $ L $ принадлежат разным компонентам.

    Обозначим через $ V_1 $ -- множество вершин первой компоненты связности, $ V_2 $ -- множество вершин второй компоненты связности,
    \[
        | V_1 | \leqslant | V_2 |.
    \]

    Для каждого ребра из $ L $ выберем одну инцидентную ему вершину следующим образом:
    \begin{enumerate}
        \item Если $ | V_1 | = 1 $, то все выбранные вершины лежат в $ V_2 $.
        \item Если $ | V_1 | > 1 $, то вершины выбраны так, чтобы среди оставшихся были вершины и из $ V_1 $, и из $ V_2 $.
    \end{enumerate}

    Множество выбранных таким образом вершин обозначим $ U $.
    \[
        | U | \leqslant | L | = \lambda.
    \]
    \begin{figure}[H]
        \centering
        \incfig{fig_29}
        \caption*{(выделены ребра $ L $, обведены вершины $ U $)}
        \label{fig:fig_29}
    \end{figure}

    Удалим из $ G $ все вершины множества $ U $, при этом будут удалены все ребра множества $ L $ и может еще какие-то ребра. Следовательно, оставшийся граф $ G - U $ будет несвязен или тривиален. Значит:
    \[
        \mathcal{X}(G) \leqslant | U | \leqslant \lambda = \lambda(G).
    \]
\end{proof}

\section{Отделимость и соединимость. Теорема Менгера.}

\begin{definition}[Разделение вершин]
    Пусть $ G = (V,E) $ -- связный граф, $ s $ и $ t $ -- две несмежные вершины. Говорят, что множество вершин $ \Omega \subset V $ \emph{разделяет} $ s $ и $ t $, если эти вершины принадлежат разным компонентам связности графа $ G - \Omega $.
\end{definition}

\begin{definition}[$ k $-отделимые вершины]
    Несмежные вершины $ s $ и $ t $ называются \emph{$ k $-отделимыми}, если $ k $ равно наименьшему числу вершин, разделяющих $ s $ и $ t $.
\end{definition}

\begin{definition}[Вершинно-независимые цепи]
    Две простые цепи, соединяющие $ s $ и $ t $, называются \emph{вершинно-независимыми}, если они не имеют общих вершин, отличных от $ s $ и $ t $.
\end{definition}

\begin{definition}[$ l $-соединимые вершины]
    Вершины $ s $ и $ t $ называются \emph{$ l $-соединимыми}, если $ l $ равно наибольшему числу вершинно-независимых цепей.
\end{definition}

\begin{theorem}[Менгер]
    В связном графе любые две несмежные вершины $ k $-отделимы $ \iff $ они $ k $-соединимы.
\end{theorem}

\section{Реберный вариант теоремы Менгера.}

\begin{definition}[Разделение вершин]
    Пусть $ G = (V,E) $ -- связный граф, $ s $ и $ t $ -- две его произвольные вершины. Говорят, что множество ребер $ R \subset E $ \emph{разделяет} $ s $ и $ t $, если эти вершины принадлежат разным компонентам связности графа $ G - R $.
\end{definition}

\begin{definition}[$ k $-реберно-отделимые вершины]
    Вершины $ s $ и $ t $ называются \emph{$ k $-реберно-отделимыми}, если $ k $ равно наименьшему числу ребер, разделяющих $ s $ и $ t $.
\end{definition}

\begin{definition}[Вершинно-независимые цепи]
    Две простые цепи, соединяющие $ s $ и $ t $, называются \emph{вершинно-независимыми}, если они не имеют общих вершин, отличных от $ s $ и $ t $.
\end{definition}

\begin{definition}[Реберно-независимые цепи]
    Две простые цепи, соединяющие $ s $ и $ t $, называются \emph{реберно-независимыми}, если они не имеют общих ребер.
\end{definition}

\begin{definition}[$ l $-реберно-соединимые вершины]
    Вершины $ s $ и $ t $ называются \emph{$ l $-реберно-соединимыми}, если наибольшее число \\ реберно-независимых $ (s,t) $-цепей равно $ l $.
\end{definition}

\begin{theorem}[Реберный аналог теоремы Менгера]
    В связном графе любые две вершины $ k $-реберно-отделимы $ \iff $ они $ k $-реберно-соединимы.
\end{theorem}