\section{Критерии вершинной и реберной $k$-связности графа.}

\begin{corollary}[Критерий вершинной $ k $-связности графа]
    Граф $ G \ k $-связен $ \iff $ любая пара его вершин соединена не менее, чем $ k $ вершинно-\\независимыми цепями.
\end{corollary}

\begin{corollary}[Критерий реберной $ k $-связности графа]
    Граф $ k $-реберно-связен $ \iff $ любая пара его вершин соединена не менее, чем $ k $ реберно-независимыми цепями.
\end{corollary}

\newpage

\section{Ориентированные графы. Основные понятия. Ормаршруты и полумаршруты. Ориентированые аналоги теоремы Менгера.}

\begin{definition}[Ориентированный граф (орграф), вершины, дуги]
    \emph{Ориентированный граф (орграф)} $ G $ состоит из непустого конечного множества $ V $ и конечного множества $ E \subset V \times V $ -- упорядоченных пар элементов множества $ V $:
    \[
        G = (V,E).
    \]

    Элементы множества $ V $ называются \emph{вершинами}, а элементы множества $ E $ -- \emph{дугами} орграфа $ G $.
\end{definition}

\begin{definition}[Ориентированный маршрут (ормаршрут), его длина, замкнутый ормаршрут]
    Пусть $ G = (V,E) $ -- орграф. \emph{Ориентированным маршрутом (ормаршрутом)} в орграфе $ G $ называется чередующаяся последовательность его вершин и дуг:
    \[
        P = (v_1,e_1,v_2,e_2,\ldots,v_k,e_k,v_{k+1}),
    \]
    в которой $ e_i = v_iv_{i+1} $ -- дуга орграфа $ G, \ i = \overline{1,k} $.

    Ормаршрут $ P $ также называется \emph{ориентированным $ (v_1,v_{k+1}) $-\\маршрутом}.

    \emph{Длина} такого маршрута равна числу $ k $ его дуг.

    Ормаршрут $ P $ называется \emph{замкнутым}, если $ v_1 = v_{k+1} $.
\end{definition}

\begin{definition}[Полумаршрут]
    Последовательность
    \[
        P = (v_1,e_1,v_2,e_2,\ldots,v_k,e_k,v_{k+1})
    \]
    вершин и дуг орграфа $ G = (V,E) $ называется \emph{полумаршрутом}, если для любого $ i = \overline{1,k} $ либо $ e_i = v_iv_{i+1}\in E $, либо $ e_i = v_{i+1}v_i \in E $.
\end{definition}

\begin{definition}[Слабо связный (слабый) орграф]
    Орграф называется \emph{слабо связным (слабым)}, если любые две его вершины соединены полумаршрутом.
\end{definition}

\newpage

\begin{note}[Доп. определения] Для ориентированной теоремы Менгера:
    \begin{definition}[Вершинно-независимые $ (s,t) $-пути]
        Два $ (s,t) $-пути называются \emph{вершинно-независимыми}, если у них нет общих вершин, отличных от $ s $ и $ t $.
    \end{definition}

    \begin{definition}[$ (s,t) $-разделяющее множество вершин]
        Множество $ W $ вершин орграфа $ G $ называется \emph{$ (s,t) $-разделяющим}, если в орграфе $ G-W $ вершина $ t $ не достижима из $ s $.
    \end{definition}
\end{note}

\begin{theorem}[Ориентированная теорема Менгера]
    Пусть $ G = (V,E) $ -- слабо связный орграф. Для любой пары вершин $ s,t \in V $ таких, что $ st \notin E $, наименьшее число вершин в $ (s,t) $-разделяющем множестве равно наибольшему числу вершинно-независимых $ (s,t) $-путей.
\end{theorem}

\begin{proof}
    Доказательство этой теоремы почти дословно, с учетом специфики орграфов, повторяет доказательство теоремы Менгера.
\end{proof}

\begin{note}[Доп. определения] Для реберного аналога ориентированной теоремы Менгера:
    \begin{definition}[Независимые по дугам $ (s,t) $-пути]
        Два $ (s,t) $-пути называются \emph{независимыми по дугам}, если они не имеют общих дуг.
    \end{definition}

    \begin{definition}[$ (s,t) $-разделяющее множество дуг]
        Множество $ R $ дуг орграфа $ G $ называется \emph{$ (s,t) $-разделяющим}, если в орграфе $ G - R $ вершина $ t $ не достижима из $ s $.
    \end{definition}
\end{note}

\begin{theorem}[Реберный аналог ориентированной теоремы Менгера]
    Пусть $ G = (V,E) $ -- слабо связный орграф. Для любой пары вершин $ s,t \in V $ наименьшее число дуг в $ (s,t) $-разделяющем множестве равно наибольшему числу независимых по дугам $ (s,t) $-путей.
\end{theorem}

\begin{proof}
    Доказательство этой теоремы почти дословно, с учетом специфики орграфов, повторяет доказательство реберного аналога теоремы Менгера.
\end{proof}

\section{Ориентированные графы. Достижимость и связность. Три типа связности. Критерии сильной, односторонней и слабой связности орграфа.}

\begin{note}
    Существует три различных понятия связности орграфа.
\end{note}

\begin{definition}[Достижимая вершина]
    Если в орграфе $ G $ существует ориентированный $ (u,v) $-маршрут, то говорят, что вершина $ v $ достижима из вершины $ u $.
\end{definition}

\begin{note}
    Любая вершина считается достижимой из самой себя.
\end{note}

\begin{definition}[Сильно связный (сильный) орграф]
    Орграф называется \emph{сильно связным (сильным)}, если любые его две вершины взаимно достижимы.
\end{definition}

\begin{definition}[Односторонне связный (односторонний) орграф]
    Орграф называется \emph{односторонне связным (односторонним)}, если для любой пары его вершин хотя бы одна достижма из другой.
\end{definition}

\begin{definition}[Слабо связный (слабый) орграф]
    Орграф называется \emph{слабо связным (слабым)}, если любые две его вершины соединены полумаршрутом.
\end{definition}

\begin{definition}[Несвязный орграф]
    Орграф называется \emph{несвязным}, если он даже не является слабым.
\end{definition}

\begin{theorem}[Критерий сильной связности]
    Орграф является сильно связным, если и только если в нем есть остовный замкнутый ормаршрут.
\end{theorem}

\begin{proof}\leavevmode
    \begin{description}
        \item[$ \boxed{\Rightarrow} $] Пусть $ G = (V,E) $ -- сильно связный орграф и $ C = (v_1,v_2,\ldots,v_k,v_1) $ -- замкнутый ормаршрут в $ G $, проходящий через максимально возможное число вершин. Предположим, что этот ормаршрут не является остовным и рассмотрим некоторую вершину $ v $, не входяющую в $ C $.

              Так как $ G $ -- сильно связный орграф, то в нем существуют ориентированный $ (v_1,v) $-маршрут $ P_1 = (v_1,u_2,\ldots,u_p,v) $ и ориентированный $ (v,v_1) $-маршрут $ P_2 = (v,\omega_2,\ldots,\omega_q,v_1) $. Но тогда замкнутый ормаршрут
              \[
                  C' = (v_1,v_2,\ldots,v_k,v_1,u_2,\ldots,u_p,v,\omega_2,\ldots,\omega_q,v_1)
              \]
              содержит большее, чем $ C $, число вершин, что противоречит выбору ормаршрута $ C $.

              Следовательно, $ C $ -- остовный ормаршрут.

        \item[$ \boxed{\Leftarrow} $] Пусть $ u,v $ -- две произвольные вершины орграфа $ G $, а \\ $ C = (v_1,v_2,\ldots,u,\ldots,v,\ldots,v_n,v_1) $ -- остовный замкнутый ормаршрут.

              Тогда вершина $ v $ достижима из $ u $ по $ (u,v) $-фрагменту ормаршрута $ C $, а вершина $ u $ достижима из $ v $ по $ (v,u) $-фрагменту $ C $.
    \end{description}
\end{proof}

\begin{theorem}[Критерий односторонней связности]
    Орграф является односторонне связным, если и только если в нем есть остовный ормаршрут.
\end{theorem}

\begin{proof}
    Аналогично доказательству теоремы о критерии сильной связности.
\end{proof}

\begin{theorem}[Критерий слабой связности]
    Орграф является слабо связным, если и только если в нем есть остовный полумаршрут.
\end{theorem}

\begin{proof}
    Аналогично доказательству теоремы о критерии сильной связности.
\end{proof}

\section{Основные структуры данных для представления графов в памяти компьютера. Их достоинства и недостатки.}

\begin{note}\leavevmode
    \begin{description}

        \item[\circled{1} \textbf{Матрица инцидентности}]
              Это матрица с $ n $ строками, соответствующими вершинам, и $ m $ столбцами, соответствующими ребрам или дугам. Для неориентированного графа столбец, соответствующий ребру $ uv $, содержит единицы в строках, соответствующих вершинам $ u,v $, и нули в остальных строках. Для орграфа столбец, соответствующий дуге $ uv $, содержит $ -1 $ в строке $ u $, $ 1 $ в строке $ v $ и нули во всех остальных строках. Петлю, то есть дугу вида $ vv $ удобно представлять значением $ 2 $ в строке $ v $.

              \begin{description}
                  \item[Достоинства.] Классический способ представления графа в теории.
                  \item[Недостатки.] С алгоритмической точки зрения, эта структура является самым худшим способом представления графа.

                        Во-первых, она требует порядка $ nm $ (то есть $ \theta(nm) $) ячее памяти, большинство из которых занято нулями.

                        Во-вторых, неудобен доступ к информации. Ответ на элементарный вопрос типа «смежны ли некоторые вершины $ u,v $?» или «существует ли вершина, смежная с данной вершиной $ v $?» требует в худшем случае просмотра всех строки, то есть $ O(m) $ шагов.
              \end{description}

        \item[\circled{2} \textbf{Матрица смежности}]
              Это квадратная матрица $ A = (a_{ij}) $ размера $ n \times n $, где
              \[
                  a_{ij} = \left\{\begin{array}{ll}
                      1, & \text{если } v_iv_j \in E  \\
                      0  & \text{в противном случае.}
                  \end{array}\right.
              \]

              В неориентированном графе $ v_iv_j \in E \iff v_jv_i \in E $, так что матрица смежности неориентированного графа симметрична, а для ориентированного графа - необязательно.
              \begin{description}
                  \item[Достоинства.] Прямой доступ к информации – возможность за один шаг получить ответ на вопрос «смежны ли некоторые вершины $ u $, $ v $?», а также удалить или добавить ребро $ uv $.
                  \item[Недостатки.]
                        Во-первых, ответ на вопрос «существует ли вершина, смежная с данной вершиной $ v $?» требует в худшем случае просмотра всей строки, т.е. $ O(n) $ операций.

                        Во-вторых, независимо от числа ребер и дуг графа объем занятой памяти составляет $ \theta(n^2) $.

                        В-третьих, начальное заполнение матрицы смежности путем «естественной» процедуры имеет трудоемкость $ \theta(n^2) $, что сразу сводит на нет алгоритмы линейной трудоемкости $ O(n) $ при работе с графами, содержащими $ O(n) $ ребер.
              \end{description}

        \item[\circled{3} \textbf{Массив ребер и дуг}]\leavevmode
              \begin{description}
                  \item[Достоинства.] Эта структура данных более предпочтительна по сравнению с $\circled{1}$ и $\circled{2}$ в смысле экономии памяти, если m $m \ll n^2 $. Для хранения всего графа потребуется всего порядка $ m $ ячеек памяти.
                  \item[Недостатки.] Ответ на каждый из основых вопросов: «смежны ли некоторые вершины $ u $, $ v $?» или «существует ли вершина, смежная с данной вершиной $ v $?» – требует в худшем случае просмотра всего массива, т.е. $ O(m) $ шагов.
              \end{description}

        \item[\circled{4} \textbf{Списки соседних вершин}]
              Это динамическая структура данных, основанная на аппарате ссылочных переменных.

              Для неориентированного графа она содержит для каждой вершины $ v \in V $ список вершин, смежных с $ v $. Каждый элемент списка является записью, содержащей информационное поле с меткой вершины $ u $, смежной с $ v $, и поле с указателем на следующий элемент списка.

              Начало каждого списка хранится в массиве $ A $ ссылочных переменных, каждый элемент $ A[v] $ которого является указателем на начало списка, содержащего вершины, смежные с вершиной $ v $. Весь такой список вместе с указателем будем обозначать $ A[v] $.
              Заметим, что для неориентированного графа каждое ребро $ uv $ представлено в списках дважды: элементом $ v $ в списке $ A[u] $ и элементом $ u $ в списке $ A[v] $.
              \begin{description}
                  \item[Достоинства.]
                        Во-первых, для отыскания вершины, смежной с данной вершиной $ v $, не нужно просматривать строку, как в матрице смежности, а достаточно лишь перейти по ссылке $ A[v] $.

                        Во-вторых, число ячеек памяти, необходимое для представления графа посредством списков соседних вершин, имеет порядок $ \theta(n + m) $.

                        В-третьих, это динамическая структура: при удалении ребра $ uv $ список $ A[u] $ автоматически «сжимается», чем достигается экономия памяти.
                  \item[Недостатки.] Для удаления ребра $ uv $ требуется $ O(n) $ операций: удалив элемент $ v $ списка $ A[u] $, необходимо отыскать элемент $ u $ в списке $ A[v] $, затратив в худшем случае $ n $ переходов по ссылке. Поэтому предпочтительнее использовать следующую модифицированную структуру данных.
              \end{description}

        \item[\circled{5} \textbf{Списки соседних вершин с перекрестными ссылками}]
              В этой структуре элемент $ v $ списка $ A[u] $ содержит ссылку на элемент $ u $ списка $ A[v] $, и наоборот.

              Заметим, что для неориентированного графа каждое ребро $ uv $ представлено в списках дважды: элементом $ v $ в списке $ A[u] $ и элементом $ u $ в списке $ A[v] $.
              \begin{description}
                  \item[Достоинства.]
                        Удаление ребра $ uv $ может быть выполнено за $ O(1) $ операций (т.е. за число операций, ограниченное константой независимо от $ n $).
                        Для этого, удалив элемент $ v $ из списка $ A[u] $, мы просто переходим по ссылке на элемент $ u $ списка $ A[v] $ и удаляем его.
                  \item[Недостатки.] По всей видимости, лишен существенных недостатков по мнению В. П. Ильева, но проверять этот факт лень. Ну он профессор, так что, думаю, ему можно доверять на слово (хоть он и не говорил ни слова из этого раздела, лол).
              \end{description}

        \item[\circled{6} \textbf{Списки соседних вершин для орграфов}]
              В этой структуре $ A[v] $ является указателем на начало списка, содержашего вершины, в которые ведут дуги из $ v $.
              \begin{description}
                  \item[Достоинства.] Для орграфа каждая дуга $ uv $ представлена лишь один раз – элементом $ v $ в списке $ A[u] $. Соответственно, удаление каждой дуги требует $ O(1) $ операций.
                  \item[Недостатки.]
                        При решении комбинаторных задач часто бывает нужно знать, какие дуги также и входят в вершину. Для этого приходится дополнительно использовать списки $ B[v] $, содержащие вершины, из которых идут дуги в вершину $ v $.

                        В ряде случаев вместо пары списков $ A $, $ B $ для представления ориентированного графа предпочтительнее использовать \emph{двумерный список}, в котором каждый элемент соответствует дуге $ uv $ и является как бы элементов сразу двух списков – «горизонтального» $ A[u] $ и «вертикального» $ B[v] $.
              \end{description}
    \end{description}
\end{note}

\section{Задача о минимальном остовном дереве. Алгоритм Прима.}

\begin{note}[ТГ постановка]
    Задан связный неориентированный граф $ G $, неотрицательная весовая функция $ c: E \rightarrow \R_+ $.

    Требуется найти связный остовной подграф графа $ G $ минимального веса.
\end{note}

\begin{remark}
    Существует связный остовной подграф минимального веса, который является остовным деревом.
\end{remark}

\begin{note}[Алгоритм Прима]
    Взвешенный неориентированный граф $ G $ будет представлен весовой матрицей, то есть симметричной матрицей $ C = (c_{ij}) $ размера $ n \times n $, где
    \[
        c_{uv} = \left\{\begin{array}{ll}
            \text{вес ребра }uv, & \text{если }uv \in E,     \\
            \infty,              & \text{если } uv \notin E.
        \end{array}\right.
    \]
    \begin{figure}[H]
        \centering
        \incfig{fig_30}
        \label{fig:fig_30}
    \end{figure}
    \[
        \begin{array}{ll}
            \text{Было:}  & d[v] = c\big[p[v],v\big] \\
            \text{Стало:} & d[v] = c[u,v]
        \end{array}
    \]
\end{note}

\section{Задача о кратчайших путях. Алгоритм Дейкстры.}

\begin{note}[ТГ постановка]
    Дан ориентированный граф $ G $, неотрицательная весовая функция $ c: E \rightarrow \R_+ $ (вес дуг интерпретируется как их длины).

    Требуется найти кратчайший путь от заданной величины $ s \in V $ до заданной вершины $ t \in V $ (при условии, что такой путь существует).
\end{note}

\begin{remark}
    Под длиной пути понимается сумма длин всех в этом пути дуг.
\end{remark}

\begin{note}[Алгоритм Дейкстры]
    Ориентированный граф $ G $ будет представлен весовой матрицей $ C = (c_{uv}), \ u,v \in V $, где
    \[
        c_{uv} = \left\{\begin{array}{ll}
            \text{вес дуги }uv, & \text{если }uv \in E,     \\
            \infty,             & \text{если } uv \notin E.
        \end{array}\right.
    \]
    \begin{figure}[H]
        \centering
        \incfig{fig_31}
        \label{fig:fig_31}
    \end{figure}
\end{note}

\section{Определение потока в сети. Увеличивающие пути. Лемма об увеличении потока.}

\begin{definition}[Поток в сети]
    \emph{Потоком} из $ s $ в $ t $ в сети $ G $ называется функция $ f: E \rightarrow \R_+ $, удовлетворяющая условиям:
    \begin{equation}\label{eq:3}
        0 \leqslant f(e) \leqslant c(e) \quad \forall e \in E,
    \end{equation}
    \begin{equation}\label{eq:4}
        \sum_{v\in A(u)}f(uv) - \sum_{v\in B(u)}f(vu) = \left\{\begin{array}{ll}
            b,  & \text{если }u = s            \\
            0,  & \text{если }u \notin \{s,t\} \\
            -b, & \text{если }u = t
        \end{array}\right..
    \end{equation}
\end{definition}

\begin{definition}[Увеличивающий путь]
    \emph{Увеличивающим путем} для потока $ f $ называется $ (s,t) $-полупуть $ P $, в котором любая прямая дуга $ e $ ненасыщена (то есть $ f(e) < c(e) $), а любая обратная дуга $ e $ непуста (то есть $ f(e) > 0 $).
\end{definition}

\begin{lemma}[Об увеличении потока]
    Если для потока $ f $ в сети $ G $ существует увеличивающий путь $ P $, то поток может быть увеличен.
\end{lemma}

\begin{proof}
    Положим $ \delta = \min(\delta_1,\delta_2) $, где
    \[
        \begin{array}{l}
            \delta_1 = \min\{c(e) - f(e): \ e \text{ -- прямая дуга }P\}>0, \\
            \delta_2 = \min\{f(e): \ e \text{ -- обратная дуга }P\}
        \end{array} \implies
    \]
    $ \implies \delta > 0 $. Положим
    \[
        f'(e) = \left\{\begin{array}{ll}
            f(e)+\delta, & \text{если }e \text{ -- прямая дуга пути }P   \\
            f(e)-\delta, & \text{если }e \text{ -- обратная дуга пути }P \\
            f(e),        & \text{в противном случае}
        \end{array}\right.
    \]

    Легко увидеть, что $ f' $ -- поток ($ f' $ удовлетворяет условиям \ref{eq:3}, \ref{eq:4}) и его величина
    \[
        b(f') = b(f) + \delta.
    \]
\end{proof}

\section{Алгоритм Эдмондса-Карпа построения максимального потока.}

\begin{note}[Алгоритм Эдмондса-Карпа]
    Пусть имеется двухполосная сеть $ G = (V,E) $ (это обыкновенный ориентированный граф), $ | V | = n, \ | E | = m $, и некоторый поток $ f $ из $ s $ в $ t $ в сети $ G $.

    Построим вспомогательную сеть $ G_f = (V,E_f) $ по правилу: $ uv \in E_f \iff $ выполнено хотя бы одно из двух условий:
    \begin{enumerate}
        \item В $ G $ есть дуга $ uv: \ f(uv) < c(uv) $.
        \item В $ G $ есть дуга $ vu: \ f(vu) > 0 $.
    \end{enumerate}

    Пропускные способности дуг сети $ G_f $ зададим следующим образом:
    \begin{itemize}
        \item если выполнено только условие $ 1. $, то $ c_f(uv) = c(uv) - f(uv) $,
        \item если выполнено только условие $ 2. $, то $ c_f(uv) = f(vu) $,
        \item если выполнены оба условия, то $ c_f(uv) = c(uv) - f(uv) + f(vu) $.
    \end{itemize}
\end{note}

\begin{example}
    $ b(f) = 1$
    \begin{figure}[H]
        \centering
        \incfig{fig_32}
        \label{fig:fig_32}
    \end{figure}
\end{example}